{% extends 'usermasterpage.html' %}
{% block content %}
<br>
    <div class="jumbotron">
    <h1 class="tittle-w3-agileits mb-4"><center><i style="color:red;">Delivery Address</i></center></h1>
    <table class="table table-bordered"  cellspacing="0" cellpadding="10" border="2px solid blue" align="center">
        <tr class="thead-dark">
            <th>Name</th>
            <th>Email</th>
            <th>Mobile</th>
            <th>Address</th>
            <th>PinCode</th>
            <th>City</th>
            <th>State</th>
            <th>Action</th>

        </tr>
        {% if ud %}
        <tr>
            <td>{{ud.userName}}</td>
            <td>{{ud.userEmail}}</td>
            <td>{{ud.userMobile}}</td>
            <td>{{ud.userAddress}}</td>
            <td>{{ud.userPinCode}}</td>
            <td>{{ud.userCity}}</td>
            <td>{{ud.userState}}</td>
            <td><a href="/user/viewprofile/?id={{ud.userEmail}}"><h4 style="color:red;">Edit</h4></a><br>

        </tr>

        {% endif %}
    </table>
</div>



<div class="jumbotron">
    <h1 class="tittle-w3-agileits mb-4"><center><i style="color:red;">Order Summary</i></center></h1>
<table class="table table-bordered"  cellspacing="10" cellpadding="10" border="2px solid blue" align="center">
    <tr class="thead-dark">
        <th><center>Image</center></th>
        <th><center>Product</center></th>
        <th><center>Price/product</center></th>
        <th><center>Size</center></th>
        <th><center>Quantity</center></th>
        <th>TotalPrice</th>
         <th><center>Action</center></th>
    </tr>
    {% if os %}
    {% for i in os %}
    <tr>
        <td><a href="/user/productdetail/"><img src="/media/{{i.product_image}}" class="log-responsive" height="100px" width="100px"></a></td>
        <td><h2 style="color:blue">{{i.product_name}}</h2></td>
        <td><h2 style="color:red;">Rs.{{i.product_price}}/-</h2></td>
        <td><h2 style="color:blue;">{{i.product_size}}</h2></td>
        <td>    <div class="cart-quantity">
        <input type='button' value='-' class='qtyminus' field ='updates_{{ i.product_id }}' />
        <input type="number" name="updates[]" id="updates_{{ i.product_id }}" class="quantity" value="{{ i.product_qty }}" />
        <input type='button' value='+' class='qtyplus' field     ='updates_{{ i.product_id }}' />
    </div></td>
        <td>
            <h2 class="myShi" id='totalprice_{{ i.product_id }}' style="color:red;">Rs.{{i.product_price}}/-</h2>
        </td>
        <td><a href="/user/remove/?id={{i.table_id}}"><b>Remove</b></a></td>
    </tr>
    {% endfor %}
    {% endif %}
    <tr align="right">
       <div><td colspan="7" style="font-size:40px;text-style:bold;color:red;background-color:skyblue;">Subtotal: {{ total.product_price__sum }}</td>
       </div></tr>



</table>

</div>

<div align="center">
    <button type="submit" class="btn btn-primary">Continue Shopping</button>
    <a href="/user/payment/"><button type="submit" class="btn btn-primary">Place order</button></a>

</div>

<br><br>

<script>
$(document).ready(function(){
    $('.qtyplus').click(function(e){
    //alert('helloplus');
        e.preventDefault();
        fieldName = $(this).attr('field');

        var geek = fieldName.split("_")
        //alert('helloattr'+geek[1]);
        var fieldPrice='#price_'+geek[1];
        //alert(fieldPrice);
        var pricedata=$(fieldPrice).attr('data-value');
        //alert(pricedata);
        var currentVal = parseInt($('input[id='+fieldName+']').val());
        if (!isNaN(currentVal)) {
            $('input[id='+fieldName+']').val(currentVal + 1);
            var tp=(currentVal + 1)*pricedata;
            var totalPrice='#totalprice_'+geek[1];
            //alert(totalPrice);
            //alert(totalprice);
            $(totalPrice).html(tp);
        } else {

            $('input[id='+fieldName+']').val(0);
        }
    });
    $(".qtyminus").click(function(e) {
        e.preventDefault();
        fieldName = $(this).attr('field');

        var geek = fieldName.split("_")
        //alert('helloattr'+geek[1]);
        var fieldPrice='#price_'+geek[1];
        //alert(fieldPrice);
        var pricedata=$(fieldPrice).attr('data-value');
        //alert(pricedata);
        //fieldName = $(this).attr('field')
        var currentVal = parseInt($('input[id='+fieldName+']').val());
        if (!isNaN(currentVal) && currentVal > 0) {
            $('input[id='+fieldName+']').val(currentVal - 1);
            var tp=(currentVal - 1)*pricedata;
            var totalPrice='#totalprice_'+geek[1];
            //alert(tp);
            //alert(totalprice);
            $(totalPrice).html(tp);

        } else {
            $('input[id='+fieldName+']').val(0);
        }
    });
});
</script>




{% endblock %}